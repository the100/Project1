WITH _PAGING_TBL AS
(
SELECT *, _PAGING_ROWNUM = ROW_NUMBER() OVER (ORDER BY Columns))
FROM Table_Expression
WHERE Conditions
)
SELECT *, (SELECT MAX(_PAGING_ROWNUM) FROM _PAGING_TBL) AS _PAGING_ROWCOUNT
FROM _PAGING_TBL
WHERE (_PAGING_ROWNUM BETWEEN (((@PageNo - 1) * @ItemSize) + 1) AND @PageNo * @ItemSize);